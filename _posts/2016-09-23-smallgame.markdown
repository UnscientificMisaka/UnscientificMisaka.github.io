---
layout:     post
title:      "html小游戏"
subtitle:   "围住神经猫，喵喵喵？"
date:       2016-09-23
author:     "LRZ"
header-img: "img/post-bg-cat.jpg"
tags:
    - HTML+CSS
    - Javascript
---

>利用html5的canvas标签，javascript的EASEIJS库


## Canvas
偶然发现知乎的登录界面很有科技感，发现是用HTML5的canvas标签做的，顿时心痒不已，拿过来用再说。
![](http://i.imgur.com/U529Xtf.jpg)
![](http://i.imgur.com/FaSTbln.jpg)
验证码没有用GD库做，暂时先这样。另外canvas做出的动画特技也很惊人，粒子特效，屏幕碎裂等效果，严格来说也不是canvas做的，js的功劳占了很多。<br/>
这两天发现canvas配合EASEIJS库也可以写网页小游戏，写个神经猫玩玩。![](http://i.imgur.com/z9hc8ex.png)<br/>
先在canvas画布上画出9x9的圆形队列，但是这样子猫有八个方向可以跑，抓猫有点难度，所以要奇数行的圆心起点向内缩进一个半径长，猫只能向六个方向跑。<br/><br/>

## Javascript
圆有三个状态:猫为蓝色，选中为橘色，未选中为灰色。扯一下最简单逻辑实现,刚开始都从初级写起，慢慢再加上算法，首先得给圆添加一个鼠标单击监听，除了猫的位置点击未选中的灰色即改变为选中时的橘色，接下来猫用if判断周围五个圆有没有橘色，没有即可向那个方向走。第一阶段的逻辑缺点很明显，代码首先判断左边，再判断右边..完全是根据你写的if顺序，随便给猫下个套，猫就懵了。猫:喵喵喵？<br/><br/>
这样相当无聊当然要给猫的智力上一个档次，分析一下猫可移动的方向有几种，左，左上，右上，右，右下，左下，原地不动，一共七种选择，猫怎么走呢，猫肯定会优先走六个方向中的一排圆全未被选中的方向，这样跑的概率是最高的。每个方向都要立一个flag决定是否走这个方向，flag的检测很简单，循环遍历这个方向的圆是否有选中的即可，如果有选中的咱就不走，换个方向。检测的同时猫也要记忆一下，哪个方向还能走几步。猫的记忆呢用数组记录就行，但是斜方向走时，比如第五排左上方走到第四排，x减1，y减1了，但第四排走到第三排x并没减1，这里需要注意判断奇偶，在改变圆的状态时也还要再注意奇偶。
<br/><br/>
但这个时候问题又来了，这只猫太聪明了，人根本围不住它。猫:喵喵喵？<br/>
缩减游戏难度，在游戏开始前随机将一些圆改为选中状态，围住就容易多了，但是猫目前还是喜欢向左和左上角跑，代码的执行顺序是这样暂时还没想好怎么改，再写个随机把，如果六个方向都可以走让它随机一个方向，但这样的话猫有时候会犯蠢很可能向回走，这属于游戏中的欢乐模式吗，没玩过原版不清楚。<br/><br/>
普通模式基于贪心算法和最大通路算法，目前很不熟悉这方面算法，暂时留以后实现。不太清楚最小步数围住猫是把所有出路围起来的步数还是直到猫一步都走不了算的步数。如果是把所有出路堵死二不至于使猫一步都动不了的话，可以利用有向图的深度遍历思想来实现。![](http://i.imgur.com/Q3uijW7.png)<br>
从左开始顺时针为方向123456，从六个方向进行深度遍历，只要遍历到边缘的点即说明猫可以跑掉，但是每次遍历都要设置一个标记，标志该节点已经判断过，避免重复判断。这可以作为判断游戏输赢的思路。但感觉猫还是太单纯会被邪恶的人类下套给抓住。猫:madan都是套路。<br/><br/>
再给猫的智商提上一把，想让猫知道你下套，比如这种情况:<br/><br/>![](http://i.imgur.com/BjOASJe.png)<br/>
猫可以走A或走B，你封了A它可以走B，但是你再把终点一堵，猫就懵了只能回走，顺势把C也堵起来，瓮中捉鳖，那怎样让猫识别出这种陷阱，智能化呢？正如围棋一样很多时候下的套并不是两三步可以看出来的，目前在下才疏学浅做不了这个功能，说到这里还是很钦佩Google的阿尔法狗的，留坑日后有进展再更新。

<hr/>
去年学得算法，忘得差不多了，找时间得重头来一遍。<br/>养猫得有个房子啊，还不知得猴年马月。问世间情为何物，两岸猿声啼不住。